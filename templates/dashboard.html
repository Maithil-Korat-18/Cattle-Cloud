<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indigo & Violet Brand Dashboard</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Material Symbols -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <span class="material-symbols-outlined">grass</span>
                </div>
                <span class="sidebar-brand">Cattle-Cloud</span>
            </div>
            
            <nav class="sidebar-nav">
                <a href="/dashboard" class="nav-item active">
                    <span class="material-symbols-outlined nav-icon filled">dashboard</span>
                    <span class="nav-text">Dashboard</span>
                </a>
                <a href="/cattle" class="nav-item ">
                    <span class="material-symbols-outlined nav-icon">pets</span>
                    <span class="nav-text">Cattle Herd</span>
                </a>
                <a href="/milk" class="nav-item">
                    <span class="material-symbols-outlined nav-icon">water_drop</span>
                    <span class="nav-text">Production</span>
                </a>
		<a href="/feed" class="nav-item">
                    <span class="material-symbols-outlined nav-icon">Feed</span>
                    <span class="nav-text">Feed</span>
                </a>
                <a href="/expenses" class="nav-item">
                    <span class="material-symbols-outlined nav-icon">account_balance_wallet</span>
                    <span class="nav-text">Finances</span>
                </a>
            </nav>
            
            <div class="sidebar-footer">
                <a href="#" class="nav-item">
                    <span class="material-symbols-outlined nav-icon">settings</span>
                    <span class="nav-text">Settings</span>
                </a>
                
                <div class="user-profile">
                    <img src="https://lh3.googleusercontent.com/aida-public/AB6AXuCPWkZjCgogEUATrDJQIusbvxGyyx9IIGNYh6W3Lew2sXZRXu816fbskZ54TpweLa5WI506LnIN_9M8ydY64TJYotY_5431t-o7tNNOWZABq2w3LAJWPUaj3sE6y_VGqTflnHAO9i5P92IKXzuBjI6YAYlLnqWAmrVe7Jhe1B-X3sjUpaAN4l3Z5UXjtVozMfEmXwxkr06CcoLzhZrGw9bUjycVZrA6tcUrG1m3cJmy1lGwQmLho5oL_d04sCZsmeFwSXTlt8TirpI" alt="Profile" class="profile-img">
                    <div class="profile-info">
                        <p class="profile-name">{{ user_name }}</p>
                    </div>
                </div>
            </div>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="page-header">
                <div class="header-left">
                    <h1 class="page-title">Good Morning, {{ user_name }}</h1>
                    <p class="page-subtitle">
                        <span class="material-symbols-outlined">calendar_today</span>
                        {{ now.strftime('%A, %b %d') }} 
                    </p>
                </div>
                <div class="header-actions">
                    <div class="search-box">
                        <span class="material-symbols-outlined search-icon">search</span>
                        <input type="text" class="form-control" placeholder="Search records...">
                    </div>
                    <button class="btn btn-outline">
                        <span class="material-symbols-outlined">description</span>
                        Generate Report
                    </button>
                    <button class="btn btn-primary-gradient">
                        <span class="material-symbols-outlined">add</span>
                        Quick Record
                    </button>
                </div>
            </header>
            
            <!-- Stats Cards -->
            <section class="stats-grid">
                <div class="stat-card">
                    <p class="stat-label">Total Cattle</p>
                    <div class="stat-value-row">
                        <h3 class="stat-value">{{ total_cattle }}</h3>
                        <span class="stat-change {{ 'positive' if cattle_change > 0 else 'negative' }}">
                            <span class="material-symbols-outlined">{{ 'arrow_upward' if cattle_change > 0 else 'arrow_downward' }}</span>
                            {{ cattle_change }}%
                        </span>
                    </div>
                </div>
                
                <div class="stat-card">
                    <p class="stat-label">Milk Yield Today</p>
                    <div class="stat-value-row">
                        <h3 class="stat-value">{{ "%.0f"|format(milk_today) }} <span class="stat-unit">L</span></h3>
                        <span class="stat-change {{ 'positive' if milk_change > 0 else 'negative' }}">
                            <span class="material-symbols-outlined">{{ 'arrow_upward' if milk_change > 0 else 'arrow_downward' }}</span>
                            {{ milk_change|abs }}%
                        </span>
                    </div>
                </div>
                
                <div class="stat-card">
                    <p class="stat-label">Monthly Revenue</p>
                    <div class="stat-value-row">
                        <h3 class="stat-value">â‚¹{{ "%.0f"|format(monthly_revenue) }}</h3>
                        <span class="stat-change {{ 'positive' if revenue_change > 0 else 'negative' }}">
                            <span class="material-symbols-outlined">{{ 'arrow_upward' if revenue_change > 0 else 'arrow_downward' }}</span>
                            {{ revenue_change }}%
                        </span>
                    </div>
                </div>
            </section>
            
            <!-- Main Content Grid -->
            <div class="content-grid">
                <!-- Left Column - Charts and Activity -->
                <div class="content-left">
                    <!-- Production Trends Chart -->
                    <div class="card chart-card">
                        <div class="card-header-flex">
                            <div>
                                <h2 class="card-title">Production Trends</h2>
                                <p class="card-subtitle">Weekly milk output performance</p>
                            </div>
                            <div class="chart-tabs">
                                <button class="chart-tab active">Daily</button>
                                <button class="chart-tab">Weekly</button>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="productionChart"></canvas>
                        </div>
                    </div>
                    
                    <!-- Recent Activity -->
                    <div class="card activity-card">
                        <div class="card-header-flex">
                            <div>
                                <h2 class="card-title">Recent Activity</h2>
                                <p class="card-subtitle">Latest farm log entries</p>
                            </div>
                            <button class="view-all-btn">View All</button>
                        </div>
                        <div class="activity-list">
                            {% for activity in recent_activities %}
                            <div class="activity-item">
                                <div class="activity-icon activity-icon-{{ activity.color }}">
                                    <span class="material-symbols-outlined">{{ activity.icon }}</span>
                                </div>
                                <div class="activity-content">
                                    <p class="activity-title">{{ activity.title }}</p>
                                    <p class="activity-description">{{ activity.description }}</p>
                                </div>
                                <span class="activity-time">{{ activity.time }}</span>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                
                <!-- Right Column - Alerts -->
                <div class="content-right">
                    <div class="card alerts-card">
                        <div class="card-header-flex">
                            <h3 class="alerts-title">
                                <span class="material-symbols-outlined">notification_important</span>
                                Alerts & Reminders
                            </h3>
                            <span class="alerts-badge">Active</span>
                        </div>
                        <div class="alerts-list">
                            {% for alert in alerts[:3] %}
                            <div class="alert-item alert-{{ alert.type }}">
                                <div class="alert-dot alert-dot-{{ alert.dot_color }}"></div>
                                <div class="alert-content">
                                    <p class="alert-title">{{ alert.title }}</p>
                                    <p class="alert-description">{{ alert.description }}</p>
                                </div>
                                <span class="material-symbols-outlined alert-arrow">arrow_forward_ios</span>
                            </div>
                            {% endfor %}
                        </div>
                        <button class="btn btn-outline btn-block">Manage Notifications</button>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Mobile FAB -->
        <button class="mobile-fab">
            <span class="material-symbols-outlined">add</span>
        </button>
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
    
    <!-- Initialize Chart with Data -->
    <script>
        // Pass weekly milk data from Flask to JavaScript
        const weeklyMilkData = {{ weekly_milk_data | tojson }};
        initializeChart(weeklyMilkData);
    </script>
</body>
</html>